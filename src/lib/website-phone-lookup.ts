/**
 * Website ↔ Phone lookup utility.
 *
 * Maps normalized (digits-only, 10-digit) phone numbers to the websites
 * that advertise them, and exposes helper functions for lookup.
 */

// ---------------------------------------------------------------------------
// Phone normalisation
// ---------------------------------------------------------------------------

/** Strip everything except digits; collapse 11-digit US numbers (leading 1) to 10. */
export function normalizePhone(phone: string): string {
  const digits = phone.replace(/\D/g, "");
  if (digits.length === 11 && digits.startsWith("1")) {
    return digits.slice(1);
  }
  return digits;
}

// ---------------------------------------------------------------------------
// Raw data  –  website \t phone  (pasted verbatim, parsed at module load)
// ---------------------------------------------------------------------------

const RAW_PAIRS: [string, string][] = [
  ["mvplimo.com", "(313) 466-5466"],
  ["partybusprices.com", "855-909-1888"],
  ["pinkcruiser.com", "248-630-5605"],
  ["35passengerpartybus.com", "855-909-1888"],
  ["detroitstripclubguide.com", "2486305605"],
  ["detroitbachelorparty.com", "248-630-5605"],
  ["detroitbacheloretteparty.com", "248-630-5605"],
  ["30passengerpartybus.com", "248-924-9889"],
  ["michigangranitetops.com", "248-924-9889"],
  ["partybussanfrancisco.com", "6283000628"],
  ["partybusphoenix.com", "480-382-1380"],
  ["nopartybus.com", "985-248-9113"],
  ["partybuslosangeles.com", "(323) 638-7180"],
  ["partybusmilwaukee.com", "414-775-3844"],
  ["partybuspuertorico.com", "855-741-3382"],
  ["partybussandiego.com", "619-928-2317"],
  ["vapartybus.com", "703-991-2088"],
  ["sacpartybus.com", "916-672-8218"],
  ["partybusvegas.com", "4025001306"],
  ["partybusraleigh.com", "9196268181"],
  ["partybusfortworth.com", "682-738-5037"],
  ["detroit-party-bus.com", "313-924-3399"],
  ["party-bus-detroit.com", "2486305605"],
  ["28passengerpartybus.com", "855-909-1888"],
  ["partybustampa.com", "813-344-3053"],
  ["limodetroit.com", "313-312-5466"],
  ["chicagopartybuses.com", "312-546-4411"],
  ["annarborpartybus.com", "734-418-9072"],
  ["detroitshuttles.com", "313-486-1444"],
  ["lincolnpartybus.com", "4022566222"],
  ["partybusnewjersey.com", "7325231449"],
  ["detroit-limo-service.com", "248-630-5605"],
  ["detroittigerspartybus.com", "248-630-5605"],
  ["40passengerpartybus.com", "855-909-1888"],
  ["detroittrolley.com", "3133125466"],
  ["atlpartybus.com", "404-476-7644"],
  ["partybusatl.com", "404-926-6588"],
  ["lansingpartybus.com", "616-953-0299"],
  ["tikipartybus.com", "248-630-5605"],
  ["porthuronpartybus.com", "810-201-4794"],
  ["partybusdallas.net", "214-438-0114"],
  ["stlouispartybus.net", "3146280321"],
  ["nycpartybus.net", "516-595-0516"],
  ["partybusorlando.com", "407-315-1508"],
  ["phillypartybus.com", "2156081515"],
  ["partybushouston.com", "7134875442"],
  ["25passengerpartybus.com", "248-630-5605"],
  ["detroitsportspartybus.com", "248-630-5605"],
  ["flintpartybus.com", "810-201-4794"],
  ["lansinglimos.com", "616-691-6116"],
  ["partybusvancouver.com", "604-670-7088"],
  ["limobusvegas.com", "702-997-4708"],
  ["limousinepittsburgh.com", "412-453-3222"],
  ["bostonlimobus.net", "617-996-8777"],
  ["partybuswashington.com", "202-600-2606"],
  ["minneapolispartybus.net", "612-430-6120"],
  ["sanfranciscolimousine.net", "6282275628"],
  ["limobusseattle.net", "206-504-1717"],
  ["metrodetroitpartybus.com", "2486005248"],
  ["miamipartybus.com", "305-574-9255"],
  ["dtwairporttransportation.com", "313-367-1333"],
  ["portlandpartybuses.com", "5038970760"],
  ["chicagolimo.cc", "312-626-2811"],
  ["sacramentopartybuses.com", "9166728218"],
  ["kansascitypartybus.net", "816-895-2877"],
  ["denverpartybus.net", "303-816-8146"],
  ["partybuswindsor.com", "226-774-0008"],
  ["partybusnyc.net", "516-847-5620"],
  ["limolosangeles.net", "323-638-7180"],
  ["raleighlimo.net", "9196268181"],
  ["detroitpartybuses.com", "248-630-5605"],
  ["limousinelasvegas.net", "7029974708"],
  ["limousineseattle.net", "206-923-9898"],
  ["limousinevancouver.net", "604-670-7088"],
  ["memphispartybus.com", "19018785650"],
  ["whistlerlimo.net", "604-670-7124"],
  ["rooftopsofwrigley.com", "3127252871"],
  ["chicagopartybus.net", "312-500-3077"],
  ["denverlimoservices.net", "720-547-2287"],
  ["detroitlimoservices.com", "313-789-3533"],
  ["limousinebuschicago.com", "312-248-9811"],
  ["newyorkpartybus.net", "5168475620"],
  ["orlandopartybus.net", "321-316-5140"],
  ["sandiegolimos.net", "619-928-2317"],
  ["partybuslansing.com", "616-953-0299"],
  ["partybuslexington.com", "859-904-5959"],
  ["lexingtonpartybus.com", "859-518-4019"],
  ["limoannarbor.com", "17344189072"],
  ["limousineannarbor.com", "734-270-4240"],
  ["jerseylimobus.com", "732-523-1449"],
  ["limousineportland.com", "503-897-0760"],
  ["limousinetoledo.com", "(419) 464-9273"],
  ["limousinewindsor.com", "226-774-0008"],
  ["partybusbaltimore.net", "443-963-3933"],
  ["partybuscharlotte.com", "7043127704"],
  ["partybusmemphis.com", "901-563-0011"],
  ["blackhornbuses.com", "512-829-1513"],
  ["dcpartybus.com", "202-858-2202"],
  ["cincinnatilimobus.com", "513-657-2996"],
  ["partybuspittsburgh.com", "412-693-6222"],
  ["warrenpartybus.com", "5864745566"],
  ["livoniapartybus.com", "734-418-9072"],
  ["shpartybus.com", "586-276-7475"],
  ["ropartybus.com", "248-630-5605"],
  ["royaloaklimousine.com", "248-206-3531"],
  ["clintontownshippartybus.com", "586-276-7475"],
  ["bloomfieldhillspartybus.com", "248-630-5605"],
  ["plymouthpartybus.com", "(734) 562-6744"],
  ["farmingtonhillspartybus.com", "248-949-2388"],
  ["westlandpartybus.com", "734-418-9072"],
  ["dgslimoservice.com", "313-312-5466"],
  ["vegaspartybus.net", "702-997-4708"],
  ["sflimos.com", "628-227-5628"],
  ["limobusatlanta.com", "404-926-6588"],
  ["cincinnati-limo.com", "513-657-2996"],
  ["chitownlimo.com", "312-626-2811"],
  ["partybusorlando.net", "407-544-5077"],
  ["partybusny.net", "516-847-5620"],
  ["limousinesindianapolis.com", "317-672-1127"],
  ["pinkpartybuses.com", "855-909-1888"],
  ["windsorpartybus.com", "226-774-0008"],
  ["whistlerlimoservice.com", "661-752-5820"],
  ["partybuslasvegas.net", "702-997-4708"],
  ["limosdetroit.net", "313-312-5466"],
  ["limowindsor.com", "226-774-0008"],
  ["limoservicesdetroit.com", "313-312-5466"],
  ["limousineslexington.com", "859-518-4019"],
  ["partybusmi.com", "313-312-5466"],
  ["partybusatlanta.net", "14049266588"],
  ["baltimore-limo.com", "443-963-3933"],
  ["lexingtonpartybus.net", "859-518-4019"],
  ["limobusannarbor.com", "734-418-9072"],
  ["limobusflint.com", "810-201-4794"],
  ["visitingdetroit.com", "3133125466"],
  ["richmondpartybus.com", "434-207-8040"],
  ["madisonlimousine.com", "608-467-4050"],
  ["detroitgranite.com", "248-924-9889"],
  ["fortworthpartybus.com", "682-307-4482"],
  ["detroitpartybus.net", "313-800-8933"],
  ["daytonabeachpartybus.com", "386-628-019"],
  ["sandiegolimobuses.com", "619-928-2317"],
  ["limobusnewyork.com", "516-847-5620"],
  ["denverlimobus.com", "720-408-7720"],
  ["limousineflint.com", "810-201-4794"],
  ["kalamazoopartybus.com", "616-202-5111"],
  ["bakersfieldpartybus.com", "661-489-7661"],
  ["partybuscedarrapids.com", "319-250-2319"],
  ["partybusoklahoma.com", "(405) 276-4405"],
  ["windsorlimos.com", "226-774-0008"],
  ["washingtonlimousine.com", "2028049022"],
  ["phillylimousine.net", "215-608-1515"],
  ["partybuskalamazoo.com", "16162025111"],
  ["partybusbatonrouge.com", "225-307-4443"],
  ["limousineslosangeles.com", "323-638-7180"],
  ["limousinebaltimore.net", "443-963-3933"],
  ["detroithummerlimo.com", "313-312-5466"],
  ["detroitlimousine.net", "13133125466"],
  ["dearbornlimousine.com", "313-921-5533"],
  ["bocaratonlimo.net", "561-566-5611"],
  ["albuquerquepartybus.com", "505-695-2630"],
  ["grpartybus.com", "(616) 202-5111"],
  ["limodelaware.com", "302-493-5112"],
  ["memphislimo.net", "901-878-5650"],
  ["sanantoniolimousine.net", "210-988-0222"],
  ["partybusphilly.com", "12156081515"],
  ["lexingtonpartybuses.com", "859-518-4019"],
  ["wichitapartybus.net", "785-310-9167"],
  ["wichitapartybuses.com", "785-310-9167"],
  ["prpartybus.com", "855-741-3382"],
  ["superbowllimousine.com", "855-909-1888"],
  ["tucsonpartybuses.com", "520-261-3547"],
  ["limossacramento.com", "916-672-8218"],
  ["clevelandlimousine.com", "440-252-2855"],
  ["limoslouisville.com", "502-878-7022"],
  ["atlantalimousinebus.com", "404-926-6588"],
  ["partybusstl.com", "314-628-0321"],
  ["temeculawinetours.info", "619-928-2317"],
  ["annarborlimo.net", "17344189072"],
  ["charterbusdetroit.com", "313-509-1633"],
  ["flintlimousine.com", "810-216-5810"],
  ["jacksonpartybuses.com", "616-953-0299"],
  ["partybustacoma.net", "12533431996"],
  ["porthuronlimousine.com", "810-201-4794"],
  ["grandrapidspartybus.net", "16164266620"],
  ["limonewyork.net", "516-847-5620"],
  ["limosacramento.net", "916-672-8218"],
  ["annarborpartybuses.com", "(734) 404-7734"],
  ["greensborolimo.net", "704-750-2160"],
  ["greensborolimos.net", "336-505-8440"],
  ["greensborolimousine.net", "704-750-2160"],
  ["limogreensboro.com", "336-505-8440"],
  ["limousinegreensboro.com", "704-750-2160"],
  ["partybussarasota.net", "19414178111"],
  ["ftmyerspartybus.net", "941-479-0390"],
  ["fortmyerspartybus.net", "941-479-0390"],
  ["partybusftmyers.net", "941-479-0390"],
  ["ftmyerslimousines.com", "239-330-6263"],
  ["fortmyerslimos.com", "239-330-6263"],
  ["fortmyerslimousines.com", "239-330-6263"],
  ["nashvillelimoservice.net", "16154885515"],
  ["ftmyerspartybus.com", "941-479-0390"],
  ["razzlimo.com", "313-312-5466"],
  ["clevelandlimobus.com", "440-252-2855"],
  ["phxlimobus.com", "480-382-1380"],
  ["limotempe.com", "14803821380"],
  ["kalamazoolimousines.com", "616-202-5111"],
  ["limousinekalamazoo.com", "616-202-5111"],
  ["limousinesnashville.com", "(615) 412-9895"],
  ["knoxvillepartybus.net", "18654989328"],
  ["ftlauderdalepartybus.net", "754-465-7577"],
  ["phoenixlimobus.net", "623-257-8440"],
  ["toledolimousine.net", "419-464-9273"],
  ["limotoledo.net", "14194649273"],
  ["limousinetoledo.net", "419-464-9273"],
  ["partybuswdc.com", "202-600-2606"],
  ["washingtonpartybus.net", "12029994646"],
  ["partybusdc.com", "202-600-2606"],
  ["partybusphoenix.net", "14803821380"],
  ["flintpartybus.net", "810-201-4794"],
  ["clevelandlimo.net", "14402522855"],
  ["waterfordlimo.com", "12489654848"],
  ["limoflint.com", "810-201-4794"],
  ["stlouislimousines.net", "314-628-0321"],
  ["stlouispartybus.com", "13146280321"],
  ["memphispartybuses.net", "19018785650"],
  ["baltimorepartybus.net", "443-963-3933"],
  ["limobaltimore.com", "443-963-3393"],
  ["dfwlimo.net", "682-738-5037"],
  ["toledolimos.com", "419-464-9273"],
  ["topartybus.com", "647-496-4261"],
  ["charlottelimo.com", "704-810-1444"],
  ["grandrapidslimo.com", "16168998181"],
  ["grandrapidslimos.com", "(616) 202-5111"],
  ["batonrougelimos.com", "225-263-6455"],
  ["limousinesanfrancisco.com", "628-227-5628"],
  ["partybuswichita.net", "17853109167"],
  ["newjerseylimos.net", "732-523-1449"],
  ["partybustallahassee.com", "850-583-8300"],
  ["partybuschicago.org", "312-725-2871"],
  ["indianapolislimo.com", "317-749-0317"],
  ["lexingtonlimos.com", "859-518-4019"],
  ["knoxvillelimo.com", "865-498-9328"],
  ["limoserviceknoxville.com", "865-498-9328"],
  ["bakersfieldlimo.com", "661-489-7661"],
  ["bakersfieldlimos.com", "661-489-7661"],
  ["flintlimos.com", "18102014794"],
  ["limousineservicedaytona.com", "904-323-0724"],
  ["limoservicewashington.com", "12026002606"],
  ["limoscharlotte.com", "704-981-6704"],
  ["phoenixpartybuses.com", "480-382-1380"],
  ["usapartybus.com", "855-909-1888"],
  ["kansascitylimobus.com", "816-895-2877"],
  ["kclimobus.com", "816-895-2877"],
  ["columbuslimos.com", "614-504-3441"],
  ["fortlauderdalelimo.net", "754-999-9377"],
  ["htownlimobus.com", "713-487-5442"],
  ["limorochester.com", "315-888-4955"],
  ["partybusbuffalo.net", "716-371-1997"],
  ["limousinecleveland.com", "440-252-2855"],
  ["houston-limos.net", "17134875442"],
  ["chicagoweddinglimousines.com", "312-626-2811"],
  ["htownlimos.com", "832-648-2832"],
  ["chicagolimoservice.com", "13126262811"],
  ["houstonpartybusservice.com", "832-358-3030"],
  ["limousinecharleston.com", "843-790-8843"],
  ["limousinestpetersburg.com", "813-489-6672"],
  ["neworleanslimousines.com", "9852489113"],
  ["albuquerquepartybus.net", "(505) 695-2630"],
  ["cedarrapidspartybus.net", "319-250-2319"],
  ["limousinetallahassee.com", "8505838300"],
  ["partybuselpaso.net", "9154125128"],
  ["limousinesiouxfalls.com", "6052995059"],
  ["limousinebatonrouge.com", "810-201-4794"],
  ["flintlimo.net", "810-201-4794"],
  ["boisepartybus.net", "208-501-2333"],
  ["limousinelansing.com", "6169530299"],
  ["madisonpartybus.net", "616-953-0299"],
  ["partybusjackson.net", "616-953-0299"],
  ["batonrougelimo.net", "225-314-1355"],
  ["limousinetucson.com", "520-261-3547"],
  ["siouxfallslimo.net", "6052995059"],
  ["louisvillelimo.net", "5028787022"],
  ["limousinefortwayne.com", "(260) 217-7222"],
  ["fortwaynepartybus.com", "(260) 217-7222"],
  ["partybuschicago.net", "(312) 471-9022"],
  ["chicagohummerlimousines.com", "312-626-2811"],
  ["partybusseattle.net", "206-923-9898"],
  ["virginialimousine.net", "703-988-7800"],
  ["limopittsburgh.com", "4126853222"],
  ["limohouston.net", "(832) 784-8822"],
  ["limocincinnati.net", "513-657-2996"],
  ["limousinesandiego.net", "619-928-2317"],
  ["phillylimousineservice.com", "619-928-2317"],
  ["limosaltlakecity.com", "801-829-1598"],
  ["limousineto.com", "647-496-4621"],
  ["newyorkcitylimobus.com", "516-847-5620"],
  ["limoservicecleveland.com", "440-252-2855"],
  ["limoservicebuffalo.com", "614-504-3441"],
  ["limobusbuffalo.com", "440-252-2855"],
  ["limocolumbus.com", "614-504-3441"],
  ["nyclimobus.com", "5168475620"],
  ["partybuseskansascity.com", "816-895-2877"],
  ["lansinglimobus.com", "6169530299"],
  ["myrtlebeachlimousine.com", "843-501-1900"],
  ["limocharlotte.com", "704-810-1444"],
  ["limoindianapolis.com", "317-672-1127"],
  ["limophiladelphia.com", "215-608-1515"],
  ["limousinephiladelphia.com", "215-608-1515"],
  ["philadelphialimos.com", "215-608-1515"],
  ["limotampabay.com", "813-563-9631"],
  ["tampalimo.com", "813-603-8813"],
  ["seattletourbus.com", "206-923-9898"],
  ["seattlecharterbus.net", "253-300-0322"],
  ["nashvillelimos.com", "615-412-9895"],
  ["newyorkpartybuses.com", "516-847-5620"],
  ["bakersfieldpartybuses.com", "661-489-7661"],
  ["bakersfieldlimousine.com", "661-441-3661"],
  ["kansascitylimos.com", "816-895-2877"],
  ["limousinekansascity.com", "816-895-2877"],
  ["limoatlanta.com", "404-926-6588"],
  ["newjerseylimo.com", "404-926-6588"],
  ["milwaukeelimos.com", "414-600-1414"],
  ["raleighlimousines.com", "513-657-2996"],
  ["sacramentolimoservice.com", "916-672-8218"],
  ["cincinnatipartybuses.com", "513-657-2996"],
  ["portlandlimousine.com", "513-657-2996"],
  ["louisvillelimousine.com", "502-878-7022"],
  ["partybuseslouisville.com", "502-878-7022"],
  ["limousinesandiego.com", "(619) 928-2317"],
  ["limosandiego.com", "619-928-2317"],
  ["bakersfieldlimobus.com", "661-489-7661"],
  ["limocedarrapids.com", "319-250-2319"],
  ["toledolimousine.com", "419-464-9273"],
  ["limobusclearwater.com", "727-500-1610"],
  ["stpetersburglimobus.com", "727-720-9332"],
  ["limobusstpetersburg.com", "727-261-1727"],
  ["limousinetempe.com", "480-382-1380"],
  ["tempelimobus.com", "480-382-1380"],
  ["grandrapidspartybuses.com", "616-202-5111"],
  ["batonrougelimobus.com", "225-307-8655"],
  ["batonrougepartybuses.com", "985-248-9113"],
  ["partybusdenver.com", "720-575-1222"],
  ["partybustampabay.com", "8134896672"],
  ["columbuslimobus.com", "614-504-3441"],
  ["raleighpartybuses.com", "9196268181"],
  ["limobuscharlotte.com", "704-810-1444"],
  ["raleighlimos.net", "919-626-8181"],
  ["tampalimousine.com", "813-489-6672"],
  ["salempartybus.com", "503-897-0760"],
  ["limousineac.com", "609-961-6013"],
  ["limobuscolumbus.com", "614-504-3441"],
  ["limousineindianapolis.com", "317-672-1127"],
  ["toledolimo.com", "419-464-9273"],
  ["grandrapidslimousines.com", "616-202-5111"],
  ["limosflint.com", "810-201-4794"],
  ["limslansing.com", "616-953-0299"],
  ["limobusraleigh.com", "919-626-8181"],
  ["columbuspartybuses.com", "614-504-3441"],
  ["limousinesanantonio.com", "210-361-1154"],
  ["pittsburghlimobuses.com", "412-201-0788"],
  ["partybusac.com", "6099616013"],
  ["limousinesaintpaul.com", "612-430-6120"],
  ["partybusescharleston.com", "843-806-0843"],
  ["savannahpartybus.com", "843-501-1900"],
  ["kalamazoopartybuses.com", "616-202-5111"],
  ["akronpartybus.com", "440-252-2855"],
  ["stpaulpartybuses.com", "612-430-6120"],
  ["limousinegalveston.com", "713-487-5442"],
  ["richmondlimoservice.com", "14342078040"],
  ["orlandopartybuses.com", "407-494-0877"],
  ["limousineanaheim.com", "657-200-5556"],
  ["greensboropartybus.com", "3366523336"],
  ["fortlauderdalepartybuses.com", "754-529-4744"],
  ["limobusjackson.com", "616-953-0299"],
  ["limostpaul.com", "612-424-2182"],
  ["charlestonlimousines.com", "843-501-1900"],
  ["battlecreeklimo.com", "616-202-5111"],
  ["lansinglimoservice.com", "616-953-0299"],
  ["limosftworth.com", "18178544717"],
  ["tempepartybuses.com", "480-382-1380"],
  ["tampapartybuses.com", "813-849-6672"],
  ["limoscharleston.com", "843-790-8843"],
  ["limousinebocaraton.com", "561-250-0511"],
  ["limotampa.net", "813-489-6672"],
  ["charlestonpartybus.net", "843-790-8843"],
  ["dclimousine.net", "202-999-4646"],
  ["limoanaheim.com", "657-200-5556"],
  ["partybusnewyorkcity.net", "15168475620"],
  ["partybusftworth.com", "18178733888"],
  ["nashvillelimousineservice.com", "16154129895"],
  ["kclimoservice.com", "816-287-1770"],
  ["limousinemilwaukee.com", "414-367-7446"],
  ["limousineftworth.com", "817-993-5777"],
  ["limobusgalveston.com", "17134875442"],
  ["partybuscharleston.net", "843-790-8843"],
  ["limousineelpaso.com", "915-412-5128"],
  ["anaheimpartybus.com", "657-200-5556"],
  ["puertoricopartybus.com", "855-741-3382"],
  ["partybusesmyrtlebeach.com", "843-501-1900"],
  ["a2limos.com", "734-418-9072"],
  ["annarborpartybusservice.com", "734-418-9072"],
  ["sanjoselimousinebus.com", "628-227-5628"],
  ["sanjosepartybus.com", "6282275628"],
  ["sacramentolimousinebus.com", "19166728218"],
  ["daytonpartybuses.com", "19375891771"],
  ["aclimousine.com", "609-961-6013"],
  ["charlottelimo.net", "704-810-1444"],
  ["milwaukeepartybus.com", "14143125414"],
  ["milwaukeelimo.net", "414-367-7446"],
  ["milwaukeelimousines.com", "414-367-7446"],
  ["atlanticcitylimobus.com", "16099616013"],
  ["partybusboulder.com", "720-262-2230"],
  ["partybussandiego.net", "619-928-2317"],
  ["limoserviceshouston.com", "(713) 581-9815"],
  ["bocaratonlimobus.com", "561-264-6411"],
  ["saintlouislimobus.com", "13146280321"],
  ["windsorlimobus.com", "226-774-0008"],
  ["windsorpartybuses.com", "12267740008"],
  ["limousinecincinnati.com", "5136572996"],
  ["madisonpartybus.com", "608-467-4050"],
  ["partybussac.com", "916-672-8218"],
  ["partybusesdenver.com", "7205131138"],
  ["partybusdallas.com", "4696207979"],
  ["limousineprovidence.com", "6178704152"],
  ["limousineboise.com", "208-501-2333"],
  ["cedarrapidslimo.com", "319-250-2319"],
  ["limoboston.com", "6178704152"],
  ["kalamazoolimo.com", "616-202-5111"],
  ["temeculalimousines.com", "619-928-2317"],
  ["moversdallas.com", "214-891-3014"],
  ["moverspittsburgh.com", "412-460-4412"],
  ["chicagocarservice.com", "(312) 494-0042"],
  ["detroitcarservice.com", "313-486-5333"],
  ["bellevuepartybus.com", "14252306335"],
  ["seattlepaintingservice.com", "206-539-1222"],
  ["austinpartybuses.com", "512-643-5111"],
  ["stpetepartybus.com", "727-270-9332"],
  ["miamipartybuses.com", "954-388-9954"],
  ["limosanantonio.com", "210-988-0222"],
  ["jacksonvillepartybuses.com", "904-351-0904"],
  ["denverpartybuses.com", "720-513-6020"],
  ["limousinechattanooga.com", "14234828444"],
  ["partybusaustintx.com", "15128291513"],
  ["limochattanooga.com", "423-482-8444"],
  ["vegaspartybus.com", "(702) 721-3313"],
  ["vegaspartybuses.com", "339-222-5134"],
  ["limobakersfield.com", "16614413661"],
  ["limousinebakersfield.com", "661-489-7661"],
  ["walimos.com", "877-365-2022"],
  ["htownpartybus.com", "17134875442"],
  ["detroitbacheloretteparty.com", "248-630-5605"],
  ["partybusflint.net", "810-201-4794"],
  ["partybustrips.com", "855-909-1888"],
  ["detpartybus.com", "248-630-5605"],
  ["chicagoslimousines.com", "312-626-2811"],
  ["phxlimousine.com", "14803821380"],
  ["louisvillepartybus.net", "15028787022"],
  ["miamilimousine.net", "305-574-9355"],
  ["partybuslansing.net", "5173176440"],
  ["atlantapartybus.net", "305-574-9355"],
  ["charterbuslansing.com", "6169530299"],
  ["partybusfortmyers.net", "941-479-0390"],
  ["annarborpartybus.net", "7344189072"],
  ["limousinenashville.com", "16154129895"],
  ["granitedetroit.com", "248-924-9889"],
  ["greensboropartybus.net", "336-505-8440"],
  ["torontopartybuses.com", "6474964261"],
  ["detlimousine.com", "3135588313"],
  ["limousinecleveland.net", "4402522855"],
  ["portlandlimoservice.net", "15038970760"],
  ["baltimorelimo.net", "14439633933"],
  ["flintcharterbus.com", "810-277-9908"],
  ["indianapolispartybus.net", "3173163777"],
  ["washingtonlimo.net", "3173163777"],
  ["newyorkcitylimos.net", "516-847-5620"],
  ["limousinenapa.net", "9166728218"],
  ["losangelespartybuses.net", "16282275628"],
  ["westlandlimo.com", "3133125466"],
  ["knoxvillelimo.net", "18654989328"],
  ["tempepartybus.net", "4803821380"],
  ["partybusbakersfield.com", "16614897661"],
  ["acpartybuses.com", "6099616013"],
  ["sarasotapartybuses.net", "9414178111"],
  ["birminghampartybus.com", "2054188108"],
  ["sanmarcospartybus.com", "5128291513"],
  ["partybussanjose.net", "14086386088"],
  ["cincylimousine.com", "15136572996"],
  ["limo312.com", "3126262811"],
  ["limokalamazoo.com", "6162025111"],
  ["limosiouxfalls.com", "6052995059"],
  ["partybusstlouis.com", "13146280321"],
  ["partybusmadison.com", "16084674050"],
  ["omahapartybus.net", "14022566222"],
  ["milwaukeelimousine.net", "4143677446"],
  ["limousinefortlauderdale.com", "7544659544"],
  ["sanfranciscolimoservice.net", "16282275628"],
  ["jacksonpartybus.net", "16169530299"],
  ["novilimo.com", "2486305605"],
  ["waterfordpartybus.com", "2486305605"],
  ["sacramentolimoservice.net", "19166728218"],
  ["sandiegopartybusservice.com", "16193040355"],
  ["cedarrapidspartybuses.com", "3192502319"],
  ["michiganlimo.net", "3133125466"],
  ["partybusnewjersey.net", "17325231449"],
  ["limocharlotte.net", "17048101444"],
  ["limojacksonville.com", "19046010904"],
  ["grossepointepartybus.com", "2486305605"],
  ["taylorpartybus.com", "7344189072"],
  ["richmondpartybus.net", "14342078040"],
  ["toledolimo.net", "14194649273"],
  ["westbloomfieldlimos.com", "2486305605"],
  ["grandrapidslimobus.com", "16162025111"],
  ["milwaukeepartybus.net", "4143677446"],
  ["memphispartybus.net", "19018785650"],
  ["pbchicago.com", "3124941481"],
  ["bostonpartybus.net", "16178704152"],
  ["phillylimos.net", "12156081515"],
  ["limobusorlando.com", "4078908585"],
  ["partybusseattle.com", "12065041717"],
  ["tacomalimos.com", "2533431996"],
  ["neworleanslimousine.com", "9852489113"],
  ["raleighlimos.com", "19196946919"],
  ["rochesterlimobus.com", "3158884955"],
  ["rochesterpartybus.net", "13158884955"],
  ["limotallahassee.com", "18505838300"],
  ["gainesvillelimos.com", "8134896672"],
  ["lexingtonlimo.com", "18599558859"],
  ["partybusinnyc.com", "15168475620"],
  ["farmingtonhillslimo.com", "2484221088"],
  ["clintontownshiplimo.com", "5867881717"],
  ["columbuslimousines.com", "6145043441"],
  ["limobushouston.com", "17139604494"],
  ["batonrougepartybus.net", "12253078122"],
  ["limousinestampa.com", "8134896672"],
  ["limostpetersburg.com", "7275137077"],
  ["southfieldpartybus.com", "2486305605"],
  ["puertoricolimo.com", "8557413382"],
  ["limobusdc.com", "12029994646"],
  ["partybusminneapolis.net", "6124306120"],
  ["detroitlimoservice.net", "3133125466"],
  ["montrealpartybus.net", "4387964496"],
  ["charlestonpartybuses.com", "8437908843"],
  ["austinpartybus.net", "15128291513"],
  ["partybusspokane.com", "15092959509"],
  ["partybuscedarrapids.net", "13192502319"],
  ["elpasopartybus.net", "9154125128"],
  ["vegaslimousinebus.com", "17029974708"],
  ["jacksonvillepartybus.com", "9043230724"],
  ["mvplimo.net", "2486305605"],
  ["seattlecoachbus.com", "12069239898"],
  ["denverlimoservice.com", "17202303280"],
  ["limoftmyers.com", "12393306263"],
  ["limokansascity.com", "816-895-2877"],
  ["limobuspittsburgh.com", "14123875222"],
  ["limousineakron.com", "14402522855"],
  ["partybusvancouver.net", "16046707088"],
  ["davenportlimo.com", "15632042233"],
  ["topekalimousine.com", "17853109167"],
  ["clearwaterlimousine.com", "18135639631"],
  ["daytonlimousines.com", "19375891771"],
  ["limoanchorage.com", "18445517750"],
  ["saltlakecitylimobus.com", "8018291598"],
  ["renolimos.net", "17755228838"],
  ["laketahoelimousine.com", "17752378751"],
  ["limousineclearwater.com", "8135639631"],
  ["limousinelincoln.com", "4022566222"],
  ["philadelphialimo.net", "12156081515"],
  ["honolulupartybus.com", "18087252225"],
  ["dallaslimousine.com", "2142259114"],
  ["tampapartybuses.net", "18134896672"],
  ["limobusfortworth.com", "18178359717"],
  ["washingtonpartybuses.com", "12026002606"],
  ["limousinememphis.net", "19018785650"],
  ["annarborlimoservice.com", "17345088806"],
  ["tucsonpartybus.com", "15208482520"],
  ["partybussaintpaul.com", "16124306120"],
  ["limonorfolk.com", "14342078040"],
  ["limogalveston.com", "17134875442"],
  ["transportationdetroit.com", "3133125466"],
  ["limooakland.com", "15106620510"],
  ["detroitpartybus.org", "4022566222"],
  ["limousineindy.com", "13176721127"],
  ["sacramentolimobus.com", "19166941616"],
  ["bmorepartybus.com", "14438730443"],
  ["partybuschicago.com", "3127252871"],
  ["stpetersburgpartybus.com", "7272709332"],
  ["clevelandpartybuses.com", "14402522855"],
  ["limousinedc.net", "2026002606"],
  ["lansingpartybus.net", "6169530299"],
  ["batonrougelimousine.com", "2254759255"],
  ["siouxfallspartybus.net", "605-299-5059"],
  ["lexington-party-bus.com", "8595184019"],
  ["flintlimobus.com", "810-201-4794"],
  ["macombpartybus.com", "5862767475"],
  ["partybusindianapolis.net", "3176721127"],
  ["saginawpartybus.com", "810-201-4794"],
  ["phlpartybus.com", "2156507554"],
  ["milwaukeelimos.net", "4143677446"],
  ["limomemphis.net", "9018785650"],
  ["partybusflint.com", "8102014794"],
  ["partybusannarbor.net", "7344189072"],
  ["neworleanslimoservice.net", "9852489113"],
  ["sacramentolimo.net", "9166728218"],
  ["houstonlimousinebus.com", "17138930012"],
  ["greensboropartybuses.com", "17047502160"],
  ["sarasotapartybuses.com", "941-417-8111"],
  ["partybusgainesville.com", "13522684433"],
  ["ftmyerspartybuses.com", "19414790390"],
  ["detroitlimo.net", "13133125466"],
  ["limousinechicago.net", "13126262811"],
  ["nolimos.com", "19852489113"],
  ["partybusnashville.net", "16154129895"],
  ["partybusatlanta.com", "14049266588"],
  ["portlandlimousines.net", "15038970760"],
  ["partybusnapa.com", "19166728218"],
  ["detroitcharterbus.net", "13133125466"],
  ["phxpartybus.com", "14803821380"],
  ["cincinnatilimo.net", "15136572996"],
  ["richmondlimo.net", "14342078040"],
  ["tacomalimo.net", "12533431996"],
  ["farmingtonlimousine.com", "12486557655"],
  ["dallaslimousineservice.net", "12142259414"],
  ["charlottelimousine.net", "17047502160"],
  ["limosjacksonville.com", "19043230724"],
  ["limobuswashington.com", "12026002606"],
  ["limosmichigan.com", "13133125466"],
  ["limoatlanticcity.net", "16099616013"],
  ["toledolimobus.net", "14194649273"],
  ["nyclimoservices.net", "15168475620"],
  ["limousinemyrtlebeach.com", "18435011900"],
  ["birminghamlimos.com", "12054188108"],
  ["newjerseypartybuses.com", "17325231449"],
  ["limoseattle.net", "12069239898"],
  ["lasvegaslimousinebus.com", "17029974708"],
  ["limodenver.net", "3039930063"],
  ["limousinecedarrapids.com", "13192502319"],
  ["partybusbuffalo.com", "17163711997"],
  ["akronlimobus.com", "14402522855"],
  ["limofortlauderdale.com", "17542197977"],
  ["philadelphialimousines.com", "215-608-1515"],
  ["nypartybuses.com", "15168475620"],
  ["limousinebustampa.com", "18134896672"],
  ["limousinestpete.com", "18134896672"],
  ["limoscolumbus.com", "16145043441"],
  ["limosbakersfield.com", "16614897661"],
  ["partybusesgrandrapids.com", "16162025111"],
  ["limosjackson.com", "16169530299"],
  ["partybusesraleigh.com", "19198879919"],
  ["grandrapidslimoservice.com", "16162025111"],
  ["phillylimousinebus.com", "12156081515"],
  ["limousinebaltimore.com", "14107343700"],
  ["limobuscharleston.com", "18437908843"],
  ["atlanticcitylimo.com", "16099616013"],
  ["limousinewashington.com", "12026002606"],
  ["santabarbarapartybus.com", "18056002611"],
  ["lalimos.com", "13236387180"],
  ["a2limousine.com", "17344189072"],
  ["partybusesjackson.com", "16169530299"],
  ["losangelespartybuses.com", "13236387180"],
  ["austinlimos.com", "15128291513"],
  ["sanfranciscopartybuses.com", "16282275628"],
  ["limousinesalem.com", "15038970760"],
  ["partybusesphoenix.com", "14804700480"],
  ["neworleanslimousine.net", "19852489113"],
  ["limobusesatlanta.com", "14049266588"],
  ["southfieldlimo.com", "12486305605"],
  ["auburnhillslimo.com", "12486305605"],
  ["sacpartybus.net", "19166728218"],
  ["nashvillelimousineservice.net", "16154129895"],
  ["wdcpartybus.com", "12026002606"],
  ["toledolimos.net", "14194649273"],
  ["annarborlimobus.com", "17344189072"],
  ["partybusindetroit.com", "248-630-5605"],
  ["limousinefortmyers.com", "239-330-6263"],
  ["detroit-limos.com", "13133125466"],
  ["partybusestampa.net", "18134896672"],
  ["stpetelimousine.com", "18134896672"],
  ["partybusesdetroit.com", "12486305605"],
  ["partybusesseattle.com", "12069239898"],
  ["limousineniagarafalls.com", "17163711997"],
  ["limobusstl.com", "13146280321"],
  ["limoservicetampa.net", "18135639631"],
  ["jerseylimo.net", "17325231449"],
  ["partybuslosangeles.net", "13236387180"],
  ["limousinesflint.com", "18102014794"],
  ["limousineslansing.com", "16169530299"],
  ["charlottelimousines.com", "17047502160"],
  ["scottsdalepartybus.com", "14803921380"],
  ["phillylimoservice.com", "12156077222"],
  ["newyorkcitypartybuses.com", "15168475620"],
  ["dallaspartyride.com", "2149450983"],
  ["austinpartyride.com", "5129008324"],
  ["houstonpartyride.com", "2815492511"],
  ["sandiegopartyride.com", "6193541420"],
  ["phoenixpartybus.net", "4803470743"],
  ["lasvegaspartyride.com", "7023428656"],
  ["denverpartyride.com", "3035367879"],
  ["findmypartybus.com", "8447254257"],
];

// ---------------------------------------------------------------------------
// Build lookup map  (normalised phone → website[])
// ---------------------------------------------------------------------------

const TEST_PHONE = "5555555555";

const phoneToWebsites = new Map<string, string[]>();

for (const [website, rawPhone] of RAW_PAIRS) {
  const norm = normalizePhone(rawPhone);

  // Skip empty / too-short / test numbers
  if (!norm || norm.length < 7 || norm === TEST_PHONE) continue;

  const existing = phoneToWebsites.get(norm);
  if (existing) {
    if (!existing.includes(website)) {
      existing.push(website);
    }
  } else {
    phoneToWebsites.set(norm, [website]);
  }
}

// ---------------------------------------------------------------------------
// Website → City mapping
// ---------------------------------------------------------------------------

const MANUAL_WEBSITE_CITY: Record<string, string> = {
  "mvplimo.com": "Detroit",
  "pinkcruiser.com": "Detroit",
  "nopartybus.com": "New Orleans",
  "vapartybus.com": "Virginia",
  "tikipartybus.com": "Detroit",
  "blackhornbuses.com": "Austin",
  "shpartybus.com": "Shelby Township",
  "ropartybus.com": "Royal Oak",
  "dgslimoservice.com": "Detroit",
  "sflimos.com": "San Francisco",
  "chitownlimo.com": "Chicago",
  "pinkpartybuses.com": "Detroit",
  "razzlimo.com": "Detroit",
  "a2limos.com": "Ann Arbor",
  "a2limousine.com": "Ann Arbor",
  "grpartybus.com": "Grand Rapids",
  "usapartybus.com": "",
  "findmypartybus.com": "",
  "partybusprices.com": "",
  "partybustrips.com": "",
  "superbowllimousine.com": "",
  "walimos.com": "",
  "limo312.com": "Chicago",
  "pbchicago.com": "Chicago",
  "nolimos.com": "New Orleans",
  "lalimos.com": "Los Angeles",
  "htownlimos.com": "Houston",
  "htownlimobus.com": "Houston",
  "htownpartybus.com": "Houston",
  "dfwlimo.net": "Dallas",
  "kclimobus.com": "Kansas City",
  "kclimoservice.com": "Kansas City",
  "bmorepartybus.com": "Baltimore",
  "phlpartybus.com": "Philadelphia",
  "detpartybus.com": "Detroit",
  "detlimousine.com": "Detroit",
  "sacpartybus.com": "Sacramento",
  "sacpartybus.net": "Sacramento",
  "partybussac.com": "Sacramento",
  "partybusmi.com": "Michigan",
  "limousineac.com": "Atlantic City",
  "partybusac.com": "Atlantic City",
  "acpartybuses.com": "Atlantic City",
  "aclimousine.com": "Atlantic City",
  "topartybus.com": "Toronto",
  "limousinedc.net": "Washington DC",
  "dcpartybus.com": "Washington DC",
  "partybusdc.com": "Washington DC",
  "partybuswdc.com": "Washington DC",
  "wdcpartybus.com": "Washington DC",
  "dclimousine.net": "Washington DC",
  "limobusdc.com": "Washington DC",
  "limousinebuschicago.com": "Chicago",
  "temeculawinetours.info": "Temecula",
  "temeculalimousines.com": "Temecula",
  "rooftopsofwrigley.com": "Chicago",
  "visitingdetroit.com": "Detroit",
  "dtwairporttransportation.com": "Detroit",
  "transportationdetroit.com": "Detroit",
  "detroitgranite.com": "Detroit",
  "granitedetroit.com": "Detroit",
  "michigangranitetops.com": "Detroit",
  "chicagoweddinglimousines.com": "Chicago",
  "chicagohummerlimousines.com": "Chicago",
  "chicagoslimousines.com": "Chicago",
  "chicagocarservice.com": "Chicago",
  "detroitcarservice.com": "Detroit",
  "seattlepaintingservice.com": "Seattle",
  "moversdallas.com": "Dallas",
  "moverspittsburgh.com": "Pittsburgh",
  "prpartybus.com": "Puerto Rico",
  "limousineto.com": "Toronto",
  "novilimo.com": "Detroit",
  "limosdetroit.net": "Detroit",
  "limoservicesdetroit.com": "Detroit",
  "limosmichigan.com": "Michigan",
  "michiganlimo.net": "Michigan",
  "partybusindetroit.com": "Detroit",
  "partybusesdetroit.com": "Detroit",
  "detroit-party-bus.com": "Detroit",
  "party-bus-detroit.com": "Detroit",
  "detroit-limo-service.com": "Detroit",
  "detroit-limos.com": "Detroit",
  "limousinelincoln.com": "Lincoln",
  "limousinesaintpaul.com": "Saint Paul",
  "phillylimousineservice.com": "Philadelphia",
  "phillylimousinebus.com": "Philadelphia",
  "phillylimos.net": "Philadelphia",
  "phillylimos.com": "Philadelphia",
  "phillylimoservice.com": "Philadelphia",
  "virginalimousine.net": "Virginia",
  "jerseylimobus.com": "New Jersey",
  "jerseylimo.net": "New Jersey",
  "newjerseylimo.com": "New Jersey",
  "seattletourbus.com": "Seattle",
  "seattlecharterbus.net": "Seattle",
  "seattlecoachbus.com": "Seattle",
  "limousinefortwayne.com": "Fort Wayne",
  "limousinefortlauderdale.com": "Fort Lauderdale",
  "limousinefortmyers.com": "Fort Myers",
  "limoftmyers.com": "Fort Myers",
  "lexington-party-bus.com": "Lexington",
  "battlecreeklimo.com": "Battle Creek",
  "royaloaklimousine.com": "Royal Oak",
  "grossepointepartybus.com": "Detroit",
  "westbloomfieldlimos.com": "Detroit",
  "southfieldpartybus.com": "Detroit",
  "southfieldlimo.com": "Detroit",
  "auburnhillslimo.com": "Detroit",
  "farmingtonhillslimo.com": "Detroit",
  "farmingtonlimousine.com": "Detroit",
  "macombpartybus.com": "Detroit",
  "clintontownshiplimo.com": "Detroit",
  "nyclimoservices.net": "New York",
  "partybusinnyc.com": "New York",
  "nyclimobus.com": "New York",
  "nycpartybus.net": "New York",
  "nypartybuses.com": "New York",
  "partybusny.net": "New York",
  "limousinesiouxfalls.com": "Sioux Falls",
  "limousinegalveston.com": "Galveston",
  "limogalveston.com": "Galveston",
  "limobusgalveston.com": "Galveston",
  "limousineanaheim.com": "Anaheim",
  "limoanaheim.com": "Anaheim",
  "limousineindy.com": "Indianapolis",
  "stlouispartybus.net": "St. Louis",
  "stlouispartybus.com": "St. Louis",
  "stlouislimousines.net": "St. Louis",
  "partybusstl.com": "St. Louis",
  "partybusstlouis.com": "St. Louis",
  "saintlouislimobus.com": "St. Louis",
  "limobusstl.com": "St. Louis",
  "limosaltlakecity.com": "Salt Lake City",
  "saltlakecitylimobus.com": "Salt Lake City",
  "laketahoelimousine.com": "Lake Tahoe",
  "santabarbarapartybus.com": "Santa Barbara",
  "sanmarcospartybus.com": "San Marcos",
  "daytonabeachpartybus.com": "Daytona Beach",
  "limousineservicedaytona.com": "Daytona Beach",
  "myrtlebeachlimousine.com": "Myrtle Beach",
  "partybusesmyrtlebeach.com": "Myrtle Beach",
  "limousinemyrtlebeach.com": "Myrtle Beach",
  "limousinestpetersburg.com": "St. Petersburg",
  "stpetersburglimobus.com": "St. Petersburg",
  "limobusstpetersburg.com": "St. Petersburg",
  "stpetersburgpartybus.com": "St. Petersburg",
  "stpetepartybus.com": "St. Petersburg",
  "limostpetersburg.com": "St. Petersburg",
  "limousinestpete.com": "St. Petersburg",
  "stpetelimousine.com": "St. Petersburg",
  "stpaulpartybuses.com": "Saint Paul",
  "limostpaul.com": "Saint Paul",
  "partybussaintpaul.com": "Saint Paul",
  "limousinechattanooga.com": "Chattanooga",
  "limochattanooga.com": "Chattanooga",
  "limoanchorage.com": "Anchorage",
  "limooakland.com": "Oakland",
  "limonorfolk.com": "Norfolk",
  "limodelaware.com": "Delaware",
  "fortlauderdalelimo.net": "Fort Lauderdale",
  "fortlauderdalepartybuses.com": "Fort Lauderdale",
  "ftlauderdalepartybus.net": "Fort Lauderdale",
  "limobusclearwater.com": "Clearwater",
  "clearwaterlimousine.com": "Clearwater",
  "limousineclearwater.com": "Clearwater",
  "davenportlimo.com": "Davenport",
};

const MULTI_WORD_CITIES: Record<string, string> = {
  "lasvegas": "Las Vegas",
  "newyork": "New York",
  "newyorkcity": "New York",
  "sanfrancisco": "San Francisco",
  "losangeles": "Los Angeles",
  "sanjose": "San Jose",
  "sandiego": "San Diego",
  "sanantonio": "San Antonio",
  "sanluis": "San Luis",
  "santabarbara": "Santa Barbara",
  "sanmarcos": "San Marcos",
  "kansascity": "Kansas City",
  "atlanticcity": "Atlantic City",
  "cedarrapids": "Cedar Rapids",
  "grandrapids": "Grand Rapids",
  "batonrouge": "Baton Rouge",
  "saltlakecity": "Salt Lake City",
  "annarbor": "Ann Arbor",
  "stlouis": "St. Louis",
  "saintlouis": "St. Louis",
  "stpaul": "Saint Paul",
  "saintpaul": "Saint Paul",
  "stpetersburg": "St. Petersburg",
  "stpete": "St. Petersburg",
  "fortworth": "Fort Worth",
  "ftworth": "Fort Worth",
  "fortmyers": "Fort Myers",
  "ftmyers": "Fort Myers",
  "fortlauderdale": "Fort Lauderdale",
  "ftlauderdale": "Fort Lauderdale",
  "fortwayne": "Fort Wayne",
  "bocaraton": "Boca Raton",
  "puertorico": "Puerto Rico",
  "daytonabeach": "Daytona Beach",
  "myrtlebeach": "Myrtle Beach",
  "niagarafalls": "Niagara Falls",
  "laketahoe": "Lake Tahoe",
  "porthuron": "Port Huron",
  "battlecreek": "Battle Creek",
  "royaloak": "Royal Oak",
  "clintontownship": "Clinton Township",
  "farmingtonhills": "Farmington Hills",
  "bloomfieldhills": "Bloomfield Hills",
  "auburnhills": "Auburn Hills",
  "grossepointe": "Grosse Pointe",
  "westbloomfield": "West Bloomfield",
  "metrodetroit": "Detroit",
  "newjersey": "New Jersey",
  "neworleans": "New Orleans",
  "elpaso": "El Paso",
  "sioux falls": "Sioux Falls",
  "siouxfalls": "Sioux Falls",
};

const DOMAIN_SUFFIXES = [
  "partybusservice", "partybuses", "partybus", "partyride",
  "limousineservice", "limousinebus", "limousines", "limousine",
  "limoservice", "limoservices", "limobuses", "limobus", "limos", "limo",
  "charterbus", "coachbus", "tourbus", "shuttles",
  "stripclubguide", "bacheloretteparty", "bachelorparty",
  "hummerlimousines", "hummerlimo", "weddinglimousines",
  "trolley", "transportation",
  "winetours", "partybusesfor",
];

function extractCityFromDomain(domain: string): string | null {
  const base = domain.replace(/\.(com|net|org|info|cc)$/, "").replace(/-/g, "");

  for (const suffix of DOMAIN_SUFFIXES) {
    if (base.endsWith(suffix) && base.length > suffix.length) {
      const city = base.slice(0, base.length - suffix.length);
      if (city.length < 2) continue;
      if (MULTI_WORD_CITIES[city]) return MULTI_WORD_CITIES[city];
      return city.charAt(0).toUpperCase() + city.slice(1);
    }
    if (base.startsWith(suffix) && base.length > suffix.length) {
      const city = base.slice(suffix.length);
      if (city.length < 2) continue;
      if (MULTI_WORD_CITIES[city]) return MULTI_WORD_CITIES[city];
      return city.charAt(0).toUpperCase() + city.slice(1);
    }
  }
  return null;
}

const websiteCityCache = new Map<string, string | null>();

export function getCityForWebsite(domain: string): string | null {
  const d = domain.toLowerCase().trim();
  if (websiteCityCache.has(d)) return websiteCityCache.get(d)!;

  // Check manual overrides first
  if (d in MANUAL_WEBSITE_CITY) {
    const city = MANUAL_WEBSITE_CITY[d] || null;
    websiteCityCache.set(d, city);
    return city;
  }

  const city = extractCityFromDomain(d);
  websiteCityCache.set(d, city);
  return city;
}

// ---------------------------------------------------------------------------
// Public API
// ---------------------------------------------------------------------------

/**
 * Return every website that shares the given phone number.
 * The input phone is normalised automatically (strips non-digits, trims
 * leading country-code "1" for 11-digit US numbers).
 * Note: When all DIDs forward to one number, the call log only shows that number,
 * so we cannot know which DID was dialed — in that case this returns [].
 */
export function getWebsitesForPhone(phone: string): string[] {
  const norm = normalizePhone(phone);
  return phoneToWebsites.get(norm) ?? [];
}

/**
 * Return the *first* (primary) website for a phone number, useful for
 * auto-populating a "lead source" field.  Returns `null` when no match.
 */
export function getLeadSourceForPhone(phone: string): string | null {
  const sites = getWebsitesForPhone(phone);
  return sites.length > 0 ? sites[0] : null;
}
